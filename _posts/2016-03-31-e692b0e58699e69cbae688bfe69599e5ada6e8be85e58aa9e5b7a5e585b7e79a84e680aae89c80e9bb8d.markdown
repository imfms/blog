---
author: F_Ms
comments: true
date: 2016-03-31 12:59:37+00:00
layout: post
link: http://f-ms.cn/?p=718
slug: '%e6%92%b0%e5%86%99%e6%9c%ba%e6%88%bf%e6%95%99%e5%ad%a6%e8%be%85%e5%8a%a9%e5%b7%a5%e5%85%b7%e7%9a%84%e6%80%aa%e8%9c%80%e9%bb%8d'
title: 撰写机房教学辅助工具的怪蜀黍
wordpress_id: 718
categories:
- article
- windows-batch
tags:
- windows-batch
---

本文主要表达机房教学辅助工具的起因、思想、路障、原理等一系列形成内容，如观看本文者曾经深受此教学辅助之害请事先准备好臭鸡蛋、烂白菜等一套砸场子道具进行观看




## 机房教学辅助工具简介


教学辅助(这么直白的给软件起名字)是博主在学校的时候使用批处理撰写的一套机房教学辅助系统，主要是针对于重启还原型机房，现主要功能为文件传输、行为管制和屏幕共享，在学校机房起到了举足轻重的地位(被黑得不轻)


## 文件传输雏


啥，机房文件传输用U盘给电脑一个一个复制？，这我就不能忍了，这么多人一个一个多慢啊，难道一个一个来能让大家更团结更融洽更促进和谐？

那咋办？ 好像确实不好办，等我这菜X闲时查查，下次给你个解决方案



	
  * 解决方案一：网络web文件服务器-HFS


一个windows平台Web文件服务器，支持上传下载限速用户管理等一套网络文件服务功能![HFS](/img/post/wp/2015/12/HFS.png)

在解决方案二出现之前，一直使用解决方案一



	
  * 解决方案二：


在接触了HFS后我开始各种倒腾各种局网服务器，后来接触到了FTP和HTTP服务器，发现Windwos资源管理器内置一个非常符合用户习惯的客户端，直接在地址栏输入FTP服务器地址就可直接进入查看FTP服务器，操作简单无需学习，就使用两款迷你FTP(FTP简易版)和HTTP(EasyWeb)软件各种拼凑了一个《F_Ms-文件服》 如下： ![02](/img/post/wp/2016/03/02-2.png)我当时还给它做了两张我现在简直不忍直视的“关于”页面 ![03](/img/post/wp/2016/03/03-1.png) ![03_2](/img/post/wp/2016/03/03_2.jpg)此工具当时相比使用HFS更简单易用，打开局网链接直接选择上传或者下载即可，然后的操作就跟平时的操作习惯相同了，所以沿用到了教学辅助出现之前


## 行为管制雏


我去，这么多玩游戏的，这是上课吗？那边都居然在5黑，老师在哪呢，我就不能忍了，得好好说说，咦，这个老师在这边训学生不让玩游戏，好吧，我去找其他老师，其他老师居然也在努力管制，好吧，我懂了，机房太大了... ...，这么简单的事肯定能想到解决方案的，恩



	
  * 解决方案一：一个老师守着一个学生



    
    啊~校长你别打我……





	
  * 解决方案二：把机房缩小，弄成一个机房一台电脑的形式



    
    啊~后勤处长你别打我……





	
  * 解决方案三：不让学生上机



    
    啊~教务处长你别打我……





	
  * 解决方案四：撰写软件工具进行管制



    
    (机房日常是网吧形式，所以会有游戏)
    打开电脑，搜索游戏盘所有程序，记录程序名称到游戏库
    使用杀进程命令游戏库从头到尾反复循环杀(taskkill命令),后台50%CPU……
    还坏坏的把游戏盘主要文件夹更名隐藏
    还把桌面游戏执行程序给篡改了加了个萌萌哒的提醒
    <img src="/img/post/wp/2016/03/01-2.png" alt="01" height="220" class="aligncenter size-full wp-image-728" width="475"></img>好吧，这个方案不好用，也没用多久，因为如果开机启动的话就直接不能完所有游戏了，但是你把这个程序发给学生让学生打开，第一次人开，第二次人要还开才怪~~~
    想象一下这个场景，老师说：“好，同学们把给大家发的程序打开哈，这样你们就玩不了游戏了”。同学们齐声喊：“好的”。




## 行动机缘


14年暑假，博主留校两个月帮助学校招生工作，鉴于博主电脑有些拙才，领导就安排博主每天打通知书。

把打通知书打印模板全部整完之后发现自己太闲了点，想来就不如学习批处理吧，学点小脚本压压身，于是从此踏上了一条批处理的不归路

有了方向总得选个路吧，就开始在网上找教程，最终决定开始学习一份名为：《十分经典的批处理教程》的批处理教程

![0003](/img/post/wp/2016/03/0003.png)

想想当年还在新浪博客每天发学习笔记，现在新浪都不用了……
想想当年还有个姑娘，现在姑娘都没有了……

之前一直以为批处理只能做本地的操作，直到有一天我学到了ftp这个命令，发现使用批处理实现网络之间的数据传输是可能的，我又打了鸡血的一样想到了可以用这个命令实现两台电脑的通信，让一台电脑根据另一台电脑的命令执行相应的操作，当我鸡冻的把这个想法告诉身边的美女化妆老师时，她充满感情和满脸懵的对我说：“奥~”。


## 实现原理


一图遮百丑

![原理](/img/post/wp/2016/03/原理.png)


## 工具初成


经过一个月多月加班熬夜(闲时间)还木辛苦费的敲代码的日子里，终于做出了一个充满Bug(后期发现)的Demo,并且记得当时教师在使用的时候输入的密码还没法做到不显示输入密码，就是不能做到这个样子[请输入密码：**********]，但是自己奇葩的为了避免这个问题竟然做出了生成三行随机数字，让教师从随机动态密码结合静态密码才能使用，已经没有老版本存档，我来P个图演示一下

恩，对的，大概就是这个样子，恩，挺漂亮

![00034](/img/post/wp/2016/03/00034.png)


## 防爆加固


虽然后来把能发现的Bug修个差不多了，但是当时教学辅助客户端是已一个正规的软件放到了正常程序安装的文件夹了，并且也没有什么监视防护，又加上批处理的原因用了很多第三方插件，学生小删一个程序就崩了，此时放寒假了，没回家，跟学校去另一个城市去打工感受生活去，每天睁眼干活闭眼睡的生活下写出了随机字符生成、随机目录跳转、以及新功能的雏形开发、为了写监视程序还专门学了十几天的VBS脚本，集成起来程序就彻彻底底的成了一个：流氓软件



	
  * 自删除，自释放

	
  * 随机目录、文件名

	
  * 第三方工具与主程分离

	
  * 监视程序也随机目录、文件名

	
  * 客户端与监视程序相互保护

	
  * ![牛虻](/img/post/wp/2016/03/牛虻.png)




## 界面美化


学校开了Flash课, 发现Flash做动画挺方便，就像着给教学辅助加一些提示界面

后来就发现了一个可以将flash动画转换为程序的工具，我当然就用啦

![05](/img/post/wp/2016/03/05.png) ![06](/img/post/wp/2016/03/06.png) ![0000011010](/img/post/wp/2016/03/0000011010.png)

后来觉得之前随便加的工具图标配不上这提示界面，于是：

![教学辅助图标](/img/post/wp/2016/03/教学辅助图标.png)


## 屏幕共享梦想





	
  * 那一年，终于脱离在线QQ远程，抱紧了局域网远程的A4腿

	
  * 那一年，我知道了VNC协议远程

	
  * 后来，我找到了UltraVNC_Viewer, 发现它支持命令行指定密码参数进行连接(当然现在视野宽了也发现了一些其它的类似viewer)

	
  * 于是我用这个工具给教学辅助增加了三个重大功能：**屏幕共享、屏幕共享和……屏幕共享**

	
  * 之前不敢想的教学辅助类软件的功能，这一天，实现了，我会记住这一天，但是我忘了哪一天了...

	
  * ![剪贴板0100000](/img/post/wp/2016/03/剪贴板0100000.png)




## “云”数据


每一次往游戏库里面添加新游戏都把程序重新生成封装自然不是一个好受的工作，每次改密码也得拆包自然也不是个好受的工作，但是苦于一直寻找云主机云空间什么都都没找着合适的(主要是钱……)


于是，我发现了一直低调的 “**七牛云储存**”，此处要大写，真心要大写，几年来找寻的终点，真心感谢七牛云存储的服务，免费又稳定，真心


为此还专门写了个教学辅助程序库&密码管理生成工具

![123412341325](/img/post/wp/2016/03/123412341325.png)


## 功能汇总





	
  * 行为管制

	
    * 程序

	
      1. 游戏

	
      2. 视频

	
      3. 音乐

	
      4. 聊天软件

	
      5. 浏览器

	
      6. #自定义#




	
    * 网络

	
      1. 游戏网站

	
      2. 视频网站

	
      3. 音乐网站

	
      4. 社交网站

	
      5. 网购网站

	
      6. 搜索引擎

	
      7. #自定义#

	
      8. #断开外网#







	
  * 文件传输

	
    * 文件发送

	
      1. 公共目录

	
      2. 发送到客户端桌面*****

	
      3. 发送到客户端并执行*****




	
    * 文件接收

	
      1. 公共目录

	
      2. #可调整是否共享#




	
    * 客户端“云”储存

	
      * 客户端文件在桌面云储存目录会自动将更改上传备份到教师机







	
  * 屏幕共享

	
    1. 强制屏幕共享*****

	
    2. 非强制屏幕共享*****

	
    3. 强制屏幕共享某台客户端到其它客户端*****

	
    4. 非强制屏幕共享某台客户端到其它客户端*****

	
    5. 远程控制某台客户端*****

	
    6. 指定某台客户端远程控制另一台客户端*****




	
  * 消息发送

	
    * 全屏快捷*****

	
    * 自定义消息*****




	
  * 关闭指定客户端*****

	
  * 临时锁定服务器

	
  * 其它功能

	
    1. 指定某台客户端解除受控*****

	
    2. 查看日志

	
    3. 查看连接过的计算机IP





[标*****代表该命令可以指定某些客户端]
[一个网段中可以有多个控制端控制不同的客户端，多个控制端选择控制的客户端归属于ip位数最小的那个]
[不对外提供(因为静态密码的原因)，如有需求或个人兴趣可邮件博主]


## 鸣谢


好，要鸣谢了，虽然这只微薄之力，并且很少有人浏览到本博，但真心感谢这些使用到的工具或服务



	
  * [七牛云存储 - 提供了库文件的在线存放](http://www.qiniu.com/)

	
  * [http.exe - 本地web服务](http://www.54bb.com)

	
  * [md5.exe - 密码存储的加密对比](http://www.fourmilab.ch/)

	
  * [ncftp.exe - ftp客户端](http://www.ncftp.com/)

	
  * [nconvert.exe - 用于生成桌面背景参数](http://www.xnview.com/en/nconvert/)

	
  * [rar.exe - 用于文件的加密、存储、压缩处理](http://www.rarlab.com/)

	
  * [ScanLine.exe - 用于扫描服务器是否开启文件服务](http://www.mcafee.com/us/downloads/free-tools/scanline.aspx)

	
  * [TightVNC - 远程控制(屏幕共享)服务](http://www.tightvnc.com/)

	
  * [UltraVNC_Viewer - 远程控制连接服务](http://www.uvnc.com/)

	
  * [timesync.exe - 用于时间同步](http://www.51240.com/timesync/)

	
  * [雅致Flash打包工具 - 用于flash画面的转程序](http://www.zage.cn)

	
  * [PortQry.exe - 用于判断服务是否开启](https://support.microsoft.com/en-us/kb/310099)

	
  * [QuickBFC - 用于编译Bat2Exe](http://www.abyssmedia.com/quickbfc/)

	
  * [ScriptCryptor - 用于Vbs2Exe](http://www.abyssmedia.com/scriptcryptor/)

	
  * SHORTCUT.EXE - 用于创建快捷方式(未能找到作者信息，感谢)

	
  * strrpc.exe - 用于字符串替换(未能找到作者信息，感谢)

	
  * PageDown - 网络文件下载(未能找到作者信息，感谢)

	
  * [批处理之家 - 学习批处理的时候自己经常去的地方](http://www.bathome.net/)

	
  * [Xlight - 底层文件服务器](http://www.xlightftpd.com/cn/)

	
  * [HFS - web网络文件服务器](http://rejetto.com/hfs/)

	
  * 在此也感谢那些被我当小白鼠的同班同学们，我在的这两年里，你们：受苦了



